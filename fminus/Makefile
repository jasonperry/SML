# Unix Makefile for lexyacc example

MOSMLHOME=/usr/share/mosml
MOSMLTOOLS=camlrunm $(MOSMLHOME)/tools
MOSMLC=mosmlc -c
MOSMLL=mosmlc
MOSMLLEX=mosmllex
MOSMLYACC=mosmlyac

all: Fmabsyn.uo Fmlexer.uo Fmparse.uo Fmtypes.uo Pmain.uo fmc
#	mosml load

Fmparse.sml Fmparse.sig: Fmparse.grm
	$(MOSMLYACC) Fmparse.grm

.SUFFIXES :
.SUFFIXES : .sml .sig .ui .uo .mlp .lex .c .o

# general rules for converting files with one extension to another. 
.sig.ui:
	$(MOSMLC) $<

.sml.uo:
	$(MOSMLC) $<

.lex.sml:
	$(MOSMLLEX) $<

fmc:	Pmain.uo
	$(MOSMLL) -o fmc Pmain.uo

depend: Fmlexer.sml Fmparse.sml 
	rm -f Makefile.bak
	mv Makefile Makefile.bak
	$(MOSMLTOOLS)/cutdeps < Makefile.bak > Makefile
	$(MOSMLTOOLS)/mosmldep >> Makefile

clean:
	rm -f Fmparse.sig Fmparse.sml Fmlexer.sml
	rm -f *.ui *.uo
	rm -f fmc
	rm -f Makefile.bak

### Dependencies, generated by mosmldep
Fmparse.ui: Fmabsyn.uo 
Fmparse.uo: Fmparse.ui Fmabsyn.uo 
Fmlexer.uo: Fmparse.ui 
Pmain.uo: FmtoC.uo Fmlexer.uo Fmtypes.uo Fmparse.ui 
Fmtypes.uo: Fmabsyn.uo 
FmtoC.uo: Fmtypes.uo Fmabsyn.uo 
